diff --git a/hitachi/hvdc_excel_reporter_final_sqm_rev (1).py b/hitachi/hvdc_excel_reporter_final_sqm_rev (1).py
index 958e688443a3d683515d765b0724f71e4b1488ff..7d95c0930d9ea2f1ae29e190a91169f0b93debe7 100644
--- a/hitachi/hvdc_excel_reporter_final_sqm_rev (1).py
+++ b/hitachi/hvdc_excel_reporter_final_sqm_rev (1).py
@@ -193,124 +193,137 @@ def validate_kpi_thresholds(stats: Dict) -> Dict:
         }

     all_pass = all(result["status"] == "PASS" for result in validation_results.values())

     logger.info(
         f"‚úÖ ÏàòÏ†ï Î≤ÑÏ†Ñ KPI Í≤ÄÏ¶ù ÏôÑÎ£å: {'ALL PASS' if all_pass else 'SOME FAILED'}"
     )
     return validation_results


 class CorrectedWarehouseIOCalculator:
     """ÏàòÏ†ïÎêú Ï∞ΩÍ≥† ÏûÖÏ∂úÍ≥† Í≥ÑÏÇ∞Í∏∞"""

     def __init__(self):
         """Ï¥àÍ∏∞Ìôî"""
         self.timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")

         # Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Í≤ΩÎ°ú ÏÑ§Ï†ï (ÌòÑÏû¨ ÎîîÎ†âÌÜ†Î¶¨ Í∏∞Ï§Ä)
         self.data_path = Path(".")  # ÌòÑÏû¨ hitachi ÎîîÎ†âÌÜ†Î¶¨
         self.hitachi_file = self.data_path / "HVDC WAREHOUSE_HITACHI(HE).xlsx"
         self.simense_file = self.data_path / "HVDC WAREHOUSE_SIMENSE(SIM).xlsx"
         self.invoice_file = self.data_path / "HVDC WAREHOUSE_INVOICE.xlsx"

         # ‚úÖ ÏàòÏ†ï: Ï∞ΩÍ≥†ÏôÄ ÌòÑÏû•ÏùÑ Î™ÖÌôïÌûà Î∂ÑÎ¶¨
         self.warehouse_columns = [
-            "AAA Storage",
-            "DSV Al Markaz",
+            "DHL Warehouse",
             "DSV Indoor",
-            "DSV MZP",
-            "DSV Outdoor",
+            "DSV Al Markaz",
             "Hauler Indoor",
+            "DSV Outdoor",
+            "DSV MZP",
+            "HAULER",
+            "JDN MZD",
             "MOSB",
-            "DHL Warehouse",
+            "AAA Storage",
         ]

         self.site_columns = ["AGI", "DAS", "MIR", "SHU"]

         # ‚úÖ ÏàòÏ†ï: ÏúÑÏπò Ïö∞ÏÑ†ÏàúÏúÑ (ÌÉÄÏù¥Î∏åÎ†àÏù¥Ïª§Ïö©)
         self.location_priority = {
             "DSV Al Markaz": 1,
             "DSV Indoor": 2,
             "DSV Outdoor": 3,
             "AAA Storage": 4,
             "Hauler Indoor": 5,
-            "DSV MZP": 6,
-            "MOSB": 7,
-            "DHL Warehouse": 8,
-            "AGI": 9,
-            "DAS": 10,
-            "MIR": 11,
-            "SHU": 12,
+            "HAULER": 6,
+            "DSV MZP": 7,
+            "JDN MZD": 8,
+            "MOSB": 9,
+            "DHL Warehouse": 10,
+            "AGI": 11,
+            "DAS": 12,
+            "MIR": 13,
+            "SHU": 14,
         }

         # Ï∞ΩÍ≥† Ïö∞ÏÑ†ÏàúÏúÑ (Í∏∞Ï°¥ Ïú†ÏßÄ)
         self.warehouse_priority = [
             "DSV Al Markaz",
             "DSV Indoor",
             "DSV Outdoor",
             "DSV MZP",
             "DSV MZD",
             "AAA Storage",
             "Hauler Indoor",
+            "HAULER",
+            "JDN MZD",
             "MOSB",
+            "DHL Warehouse",
         ]

         # ‚úÖ FIX 1: SQM Í∏∞Î∞ò Ï∞ΩÍ≥† Í¥ÄÎ¶¨ ÏÑ§Ï†ï (AAA Storage Ìè¨Ìï®)
         self.warehouse_base_sqm = {
             "DSV Al Markaz": 12000,
             "DSV Indoor": 8500,
             "DSV Outdoor": 15000,
             "DSV MZP": 1000,
             "DSV MZD": 1000,
             "AAA Storage": 2000,  # ‚úÖ AAA Storage Ïö©Îüâ ÏÑ§Ï†ï
             "Hauler Indoor": 1000,
+            "HAULER": 1000,
+            "JDN MZD": 1000,
             "MOSB": 10000,
             "DHL Warehouse": 1000,
         }

         # ‚úÖ NEW: Í≥ºÍ∏à Î™®Îìú Ï†ïÏùò (rate-based / passthrough / no-charge)
         self.billing_mode = {
             "DSV Outdoor": "rate",
             "DSV MZP": "rate",
             "DSV Indoor": "rate",
             "DSV Al Markaz": "rate",
             "AAA Storage": "passthrough",
             "Hauler Indoor": "passthrough",
+            "HAULER": "passthrough",
+            "JDN MZD": "rate",
             "DHL Warehouse": "passthrough",
             "MOSB": "no-charge",
         }

         # ‚úÖ FIX: Í≥ÑÏïΩ Îã®Í∞Ä (AED/sqm/month) ‚Äî rate Î™®ÎìúÏóêÎßå ÏùòÎØ∏
         self.warehouse_sqm_rates = {
             "DSV Outdoor": 18.0,  # Rate-Í∏∞Î∞ò
             "DSV MZP": 33.0,  # Rate-Í∏∞Î∞ò
             "DSV Indoor": 47.0,  # Rate-Í∏∞Î∞ò
             "DSV Al Markaz": 47.0,  # Rate-Í∏∞Î∞ò
             # passthrough/no-chargeÎäî Îã®Í∞Ä ÎØ∏ÏÇ¨Ïö©
             "AAA Storage": 0.0,
             "Hauler Indoor": 0.0,
+            "HAULER": 0.0,
+            "JDN MZD": 33.0,
             "DHL Warehouse": 0.0,
             "MOSB": 0.0,
         }

         # Flow Code Îß§Ìïë (v3.3-flow override Ï†ïÏ†ï)
         self.flow_codes = {
             0: "Pre Arrival",
             1: "Port ‚Üí Site",
             2: "Port ‚Üí WH ‚Üí Site",
             3: "Port ‚Üí WH ‚Üí MOSB ‚Üí Site",
             4: "Port ‚Üí WH ‚Üí WH ‚Üí MOSB ‚Üí Site",
         }

         # Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Î≥ÄÏàò
         self.combined_data = None
         self.total_records = 0

         logger.info("üèóÔ∏è ÏàòÏ†ïÎêú HVDC ÏûÖÍ≥† Î°úÏßÅ Íµ¨ÌòÑ Î∞è ÏßëÍ≥Ñ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å")
         logger.info("üè¢ Ï∞ΩÍ≥† vs ÌòÑÏû• Î∂ÑÎ¶¨ + Ï†ïÌôïÌïú Ï∂úÍ≥† ÌÉÄÏù¥Î∞ç + Ïû¨Í≥† Í≤ÄÏ¶ù Í∞ïÌôî")

     def build_passthrough_amounts(self, invoice_df: pd.DataFrame) -> dict:
         """
         ‚úÖ NEW: Ïù∏Î≥¥Ïù¥Ïä§ ÏõêÎ≥∏ÏóêÏÑú (YYYY-MM, Warehouse)Î≥Ñ Ï¥ùÏï°ÏùÑ dictÎ°ú Íµ¨ÏÑ±
         Í∏∞ÎåÄ Ïª¨Îüº: Month(YYYY-MM), Warehouse, Invoice_Amount(AED)

@@ -487,60 +500,52 @@ class CorrectedWarehouseIOCalculator:
                         print(f"   ‚ö†Ô∏è {warehouse}: Ïª¨Îüº Ï∂îÍ∞ÄÎê® (Îπà Í∞í)")
                     else:
                         non_null_count = self.combined_data[warehouse].notna().sum()
                         print(f"   ‚úÖ {warehouse}: {non_null_count}Í±¥ Îç∞Ïù¥ÌÑ∞")

                 if missing_warehouses:
                     logger.warning(
                         f"‚ö†Ô∏è ÎàÑÎùΩÎêú Ï∞ΩÍ≥† Ïª¨ÎüºÎì§Ïù¥ Îπà Í∞íÏúºÎ°ú Ï∂îÍ∞ÄÎê®: {missing_warehouses}"
                     )

                 logger.info(f"üîó Îç∞Ïù¥ÌÑ∞ Í≤∞Ìï© ÏôÑÎ£å: {self.total_records}Í±¥")
             else:
                 raise ValueError("Î°úÎìúÌï† Îç∞Ïù¥ÌÑ∞ ÌååÏùºÏù¥ ÏóÜÏäµÎãàÎã§.")

         except Exception as e:
             logger.error(f"‚ùå Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®: {str(e)}")
             raise

         return self.combined_data

     def _override_flow_code(self):
         """üîß Flow Code Ïû¨Í≥ÑÏÇ∞ (v3.4-corrected: Off-by-One Î≤ÑÍ∑∏ ÏàòÏ†ï)"""
         logger.info("üîÑ v3.4-corrected: Off-by-One Î≤ÑÍ∑∏ ÏàòÏ†ï + Pre Arrival Ï†ïÌôï ÌåêÎ≥Ñ")

         # Ï∞ΩÍ≥† Ïª¨Îüº (MOSB Ï†úÏô∏, Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Í∏∞Ï§Ä)
-        WH_COLS = [
-            "AAA Storage",
-            "DSV Al Markaz",
-            "DSV Indoor",
-            "DSV MZP",
-            "DSV Outdoor",
-            "Hauler Indoor",
-            "DHL Warehouse",
-        ]
-        MOSB_COLS = ["MOSB"]
+        WH_COLS = [w for w in self.warehouse_columns if w != "MOSB"]
+        MOSB_COLS = [w for w in self.warehouse_columns if w == "MOSB"]

         # ‚ë† wh handling Í∞íÏùÄ Î≥ÑÎèÑ Î≥¥Ï°¥ (ÏõêÎ≥∏ Ïú†ÏßÄ)
         if "wh handling" in self.combined_data.columns:
             # ‚úÖ FIX 3: ÏõêÎ≥∏ Îç∞Ïù¥ÌÑ∞ Ïö∞ÏÑ† Î≥¥Ï°¥
             original_wh_handling = self.combined_data["wh handling"].copy()
             self.combined_data["wh_handling_original"] = original_wh_handling
             self.combined_data.rename(
                 columns={"wh handling": "wh_handling_legacy"}, inplace=True
             )
             logger.info(
                 "üìã Í∏∞Ï°¥ 'wh handling' Ïª¨ÎüºÏùÑ 'wh_handling_original'Í≥º 'wh_handling_legacy'Î°ú Î≥¥Ï°¥"
             )

         # ‚ë° 0Í∞íÍ≥º Îπà Î¨∏ÏûêÏó¥ÏùÑ NaNÏúºÎ°ú ÏπòÌôò (notna() Ïò§Î•ò Î∞©ÏßÄ)
         for col in WH_COLS + MOSB_COLS:
             if col in self.combined_data.columns:
                 self.combined_data[col] = self.combined_data[col].replace(
                     {0: np.nan, "": np.nan}
                 )

         # ‚ë¢ Î™ÖÏãúÏ†Å Pre Arrival ÌåêÎ≥Ñ
         status_col = "Status_Location"
         if status_col in self.combined_data.columns:
             is_pre_arrival = self.combined_data[status_col].str.contains(
                 "Pre Arrival", case=False, na=False
@@ -1566,71 +1571,53 @@ class HVDCExcelReporterFinal:
             "direct_result": direct_result,
             "inbound_pivot": inbound_pivot,
             "processed_data": df,
             # ‚úÖ NEW: SQM Í¥ÄÎ†® Í≤∞Í≥º Ï∂îÍ∞Ä
             "sqm_inbound": sqm_inbound,
             "sqm_outbound": sqm_outbound,
             "sqm_cumulative_inventory": sqm_cumulative,
             "sqm_invoice_charges": sqm_charges,
             "sqm_data_quality": sqm_quality,
         }

     def create_warehouse_monthly_sheet(self, stats: Dict) -> pd.DataFrame:
         """Ï∞ΩÍ≥†_ÏõîÎ≥Ñ_ÏûÖÏ∂úÍ≥† ÏãúÌä∏ ÏÉùÏÑ± (ÎèôÏùº ÎÇ†Ïßú Ï∞ΩÍ≥†Í∞Ñ Ïù¥Îèô Î∞òÏòÅ)"""
         logger.info("üè¢ Ï∞ΩÍ≥†_ÏõîÎ≥Ñ_ÏûÖÏ∂úÍ≥† ÏãúÌä∏ ÏÉùÏÑ± (Ï∞ΩÍ≥†Í∞Ñ Ïù¥Îèô Î∞òÏòÅ)")

         # ÏõîÎ≥Ñ Í∏∞Í∞Ñ ÏÉùÏÑ± (2023-02 ~ 2025-07)
         months = pd.date_range("2023-02", "2025-07", freq="MS")
         month_strings = [month.strftime("%Y-%m") for month in months]

         # Í≤∞Í≥º DataFrame Ï¥àÍ∏∞Ìôî
         results = []

         for month_str in month_strings:
             row = [month_str]  # Ï≤´ Î≤àÏß∏ Ïª¨Îüº: ÏûÖÍ≥†Ïõî

-            # ‚úÖ FIX 1: Ï∞ΩÍ≥† Î™©Î°ù (AAA Storage Ìè¨Ìï® ÌôïÏù∏)
-            warehouses = [
-                "AAA Storage",
-                "DSV Al Markaz",
-                "DSV Indoor",
-                "DSV MZP",
-                "DSV Outdoor",
-                "Hauler Indoor",
-                "MOSB",
-                "DHL Warehouse",
-            ]
-            warehouse_display_names = [
-                "AAA Storage",
-                "DSV Al Markaz",
-                "DSV Indoor",
-                "DSV MZP",
-                "DSV Outdoor",
-                "Hauler Indoor",
-                "MOSB",
-                "DHL Warehouse",
-            ]
+            # ‚úÖ Stage-1 Ï†ïÍ∑úÌôî ÏàúÏÑú Í∏∞Î∞ò Ï∞ΩÍ≥† Î™©Î°ù ÏÇ¨Ïö©
+            warehouses = list(self.calculator.warehouse_columns)
+            warehouse_display_names = list(self.calculator.warehouse_columns)

             inbound_values = []

             # ÏûÖÍ≥† Í≥ÑÏÇ∞ (ÏàúÏàò ÏûÖÍ≥† + Ï∞ΩÍ≥†Í∞Ñ Ïù¥Îèô ÏûÖÍ≥†)
             for i, warehouse in enumerate(warehouses):
                 inbound_count = 0

                 # 1. ÏàúÏàò ÏûÖÍ≥† (external_arrival)
                 for item in stats["inbound_result"].get("inbound_items", []):
                     if (
                         item.get("Warehouse") == warehouse
                         and item.get("Year_Month") == month_str
                         and item.get("Inbound_Type") == "external_arrival"
                     ):
                         inbound_count += item.get("Pkg_Quantity", 1)

                 # 2. Ï∞ΩÍ≥†Í∞Ñ Ïù¥Îèô ÏûÖÍ≥† (ÌÇ§ Ïù¥Î¶Ñ ÏàòÏ†ï)
                 for transfer in stats["inbound_result"].get("warehouse_transfers", []):
                     if (
                         transfer.get("to_warehouse") == warehouse
                         and transfer.get("Year_Month") == month_str
                     ):
                         inbound_count += transfer.get("pkg_quantity", 1)

                 inbound_values.append(inbound_count)
@@ -1644,58 +1631,58 @@ class HVDCExcelReporterFinal:
                 # Ï∞ΩÍ≥†Í∞Ñ Ïù¥Îèô Ï∂úÍ≥†
                 for transfer in stats["inbound_result"].get("warehouse_transfers", []):
                     if (
                         transfer.get("from_warehouse") == warehouse
                         and transfer.get("Year_Month") == month_str
                     ):
                         outbound_count += transfer.get("pkg_quantity", 1)

                 # Ï∞ΩÍ≥†‚ÜíÌòÑÏû• Ï∂úÍ≥† (ÌÇ§ Ïù¥Î¶Ñ ÏàòÏ†ï)
                 for item in stats["outbound_result"].get("outbound_items", []):
                     if (
                         item.get("From_Location") == warehouse
                         and item.get("Year_Month") == month_str
                     ):
                         outbound_count += item.get("Pkg_Quantity", 1)

                 outbound_values.append(outbound_count)
                 row.append(outbound_count)

             # ÎàÑÍ≥Ñ Ïó¥ Ï∂îÍ∞Ä
             row.append(sum(inbound_values))  # ÎàÑÍ≥Ñ_ÏûÖÍ≥†
             row.append(sum(outbound_values))  # ÎàÑÍ≥Ñ_Ï∂úÍ≥†

             results.append(row)

-        # Ïª¨Îüº ÏÉùÏÑ± (19Ïó¥)
+        # Ïª¨Îüº ÏÉùÏÑ± (ÏûÖÍ≥†Ïõî + ÏûÖÍ≥†/Ï∂úÍ≥† √ó Ï∞ΩÍ≥†Ïàò + ÎàÑÍ≥Ñ 2Ïó¥)
         columns = ["ÏûÖÍ≥†Ïõî"]

-        # ÏûÖÍ≥† 8Í∞ú Ï∞ΩÍ≥†
+        # ÏûÖÍ≥† NÍ∞ú Ï∞ΩÍ≥†
         for warehouse in warehouse_display_names:
             columns.append(f"ÏûÖÍ≥†_{warehouse}")

-        # Ï∂úÍ≥† 8Í∞ú Ï∞ΩÍ≥†
+        # Ï∂úÍ≥† NÍ∞ú Ï∞ΩÍ≥†
         for warehouse in warehouse_display_names:
             columns.append(f"Ï∂úÍ≥†_{warehouse}")

         # ÎàÑÍ≥Ñ Ïó¥
         columns.append("ÎàÑÍ≥Ñ_ÏûÖÍ≥†")
         columns.append("ÎàÑÍ≥Ñ_Ï∂úÍ≥†")

         # DataFrame ÏÉùÏÑ±
         warehouse_monthly = pd.DataFrame(results, columns=columns)

         # Ï¥ùÌï©Í≥Ñ Ìñâ Ï∂îÍ∞Ä
         total_row = ["Total"]
         for col in warehouse_monthly.columns[1:]:
             total_row.append(warehouse_monthly[col].sum())
         warehouse_monthly.loc[len(warehouse_monthly)] = total_row

         logger.info(
             f"‚úÖ Ï∞ΩÍ≥†_ÏõîÎ≥Ñ_ÏûÖÏ∂úÍ≥† ÏãúÌä∏ ÏôÑÎ£å (Ï∞ΩÍ≥†Í∞Ñ Ïù¥Îèô Î∞òÏòÅ): {warehouse_monthly.shape}"
         )
         return warehouse_monthly

     def create_site_monthly_sheet(self, stats: Dict) -> pd.DataFrame:
         """ÌòÑÏû•_ÏõîÎ≥Ñ_ÏûÖÍ≥†Ïû¨Í≥† ÏãúÌä∏ ÏÉùÏÑ± (Multi-Level Header 9Ïó¥) - Ï§ëÎ≥µ ÏóÜÎäî Ïã§Ï†ú ÌòÑÏû• ÏûÖÍ≥†Îßå ÏßëÍ≥Ñ"""
         logger.info("üèóÔ∏è ÌòÑÏû•_ÏõîÎ≥Ñ_ÏûÖÍ≥†Ïû¨Í≥† ÏãúÌä∏ ÏÉùÏÑ± (9Ïó¥, Ï§ëÎ≥µ ÏóÜÎäî ÏßëÍ≥Ñ)")

@@ -1830,53 +1817,51 @@ class HVDCExcelReporterFinal:
             .sum()
             .rename(columns={"Pkg": "value"})
         )
         nodes = sorted(set(g["From"]).union(set(g["To"])))
         node_index = {n: i for i, n in enumerate(nodes)}
         g["source"] = g["From"].map(node_index)
         g["target"] = g["To"].map(node_index)
         return g[["source", "target", "value"]], nodes

     def _ftd__kpis(self, df: pd.DataFrame, segments: pd.DataFrame) -> dict:
         """KPI: MOSB ÌÜµÍ≥ºÏú®, ÏßÅÏÜ° ÎπÑÏú®(FLOW_CODE=1), WH ÌèâÍ∑† Ï≤¥Î•ò(Port/WH Íµ¨Í∞Ñ)"""
         if segments.empty:
             mosb_rate = 0.0
             avg_wh_dwell = 0.0
         else:
             cases_with_mosb = (
                 segments.assign(
                     has_mosb=lambda d: (d["From"].eq("MOSB") | d["To"].eq("MOSB"))
                 )
                 .groupby("Case")["has_mosb"]
                 .max()
                 .mean()
             )
             mosb_rate = float(cases_with_mosb) * 100.0

-            wh_nodes = set(
-                ["Port", "AAA Storage", "DSV Indoor", "DSV Al Markaz", "DSV Outdoor"]
-            )
+            wh_nodes = set(["Port"] + list(self.calculator.warehouse_columns))
             wh_dwell = segments[segments["From"].isin(wh_nodes)]["Dwell_Days"]
             avg_wh_dwell = float(wh_dwell.mean()) if not wh_dwell.empty else 0.0

         if "FLOW_CODE" in df.columns:
             total_cases = df.shape[0]
             direct_cases = int((df["FLOW_CODE"] == 1).sum())
             direct_rate = (direct_cases / total_cases * 100.0) if total_cases else 0.0
         else:
             direct_rate = 0.0

         return {
             "MOSB_Pass_Rate_%": round(mosb_rate, 2),
             "Direct_Flow_Rate_%": round(direct_rate, 2),
             "Avg_WH_Dwell_Days": round(avg_wh_dwell, 2),
         }

     def create_flow_traceability_frames(self, stats: dict) -> dict:
         """Flow Traceability (Sankey + Timeline + KPI) ÌîÑÎ†àÏûÑ ÏÉùÏÑ±.
         Ï∂úÎ†•:
           - sankey_links: source,target,value
           - sankey_nodes: [label...]
           - timeline_segments: Case,From,To,Start,End,Dwell_Days,Pkg
           - kpis: dict
         """
         df = stats.get("processed_data")
@@ -1911,70 +1896,60 @@ class HVDCExcelReporterFinal:
         links.to_excel(writer, sheet_name="Flow_Sankey_Links", index=False)

         timeline = frames.get("timeline_segments", pd.DataFrame())
         if timeline is None:
             timeline = pd.DataFrame()
         if not timeline.empty:
             timeline = timeline.copy()
             for col in ["Start", "End"]:
                 if col in timeline.columns:
                     timeline[col] = pd.to_datetime(timeline[col]).dt.strftime(
                         "%Y-%m-%d %H:%M:%S"
                     )
         timeline.to_excel(writer, sheet_name="Flow_Timeline", index=False)

         kpis = frames.get("kpis", {})
         if kpis:
             pd.DataFrame([kpis]).to_excel(writer, sheet_name="Flow_KPI", index=False)

     # === END MACHO PATCH: Flow Traceability Dashboard ===

     def create_multi_level_headers(
         self, df: pd.DataFrame, sheet_type: str
     ) -> pd.DataFrame:
         """Multi-Level Header ÏÉùÏÑ± (Í∞ÄÏù¥Îìú ÌëúÏ§Ä)"""
         if sheet_type == "warehouse":
-            # Ï∞ΩÍ≥† Multi-Level Header: 19Ïó¥ (Location + ÏûÖÍ≥†8 + Ï∂úÍ≥†8)
+            warehouses = list(self.calculator.warehouse_columns)
+            # Ï∞ΩÍ≥† Multi-Level Header: ÏûÖÍ≥†Ïõî + (ÏûÖÍ≥†/Ï∂úÍ≥† √ó Ï∞ΩÍ≥†Ïàò)
             level_0 = ["ÏûÖÍ≥†Ïõî"]  # Ï≤´ Î≤àÏß∏ Ïª¨Îüº
             level_1 = [""]

-            # ‚úÖ FIX 1: ÏûÖÍ≥† 8Í∞ú Ï∞ΩÍ≥† (AAA Storage Ìè¨Ìï®)
-            warehouses = [
-                "AAA Storage",
-                "DSV Al Markaz",
-                "DSV Indoor",
-                "DSV MZP",
-                "DSV Outdoor",
-                "Hauler Indoor",
-                "MOSB",
-                "DHL Warehouse",
-            ]
             for warehouse in warehouses:
                 level_0.append("ÏûÖÍ≥†")
                 level_1.append(warehouse)

-            # Ï∂úÍ≥† 8Í∞ú Ï∞ΩÍ≥† (ÎèôÏùº ÏàúÏÑú)
+            # Ï∂úÍ≥† NÍ∞ú Ï∞ΩÍ≥† (ÎèôÏùº ÏàúÏÑú)
             for warehouse in warehouses:
                 level_0.append("Ï∂úÍ≥†")
                 level_1.append(warehouse)

             multi_columns = pd.MultiIndex.from_arrays(
                 [level_0, level_1], names=["Type", "Location"]
             )

         elif sheet_type == "site":
             # ÌòÑÏû• Multi-Level Header: 9Ïó¥ (Location + ÏûÖÍ≥†4 + Ïû¨Í≥†4)
             level_0 = ["ÏûÖÍ≥†Ïõî"]  # Ï≤´ Î≤àÏß∏ Ïª¨Îüº
             level_1 = [""]

             # ÏûÖÍ≥† 4Í∞ú ÌòÑÏû• (Í∞ÄÏù¥Îìú ÏàúÏÑú)
             sites = ["AGI", "DAS", "MIR", "SHU"]
             for site in sites:
                 level_0.append("ÏûÖÍ≥†")
                 level_1.append(site)

             # Ïû¨Í≥† 4Í∞ú ÌòÑÏû• (ÎèôÏùº ÏàúÏÑú)
             for site in sites:
                 level_0.append("Ïû¨Í≥†")
                 level_1.append(site)

             multi_columns = pd.MultiIndex.from_arrays(
@@ -2584,61 +2559,53 @@ def test_same_date_warehouse_transfer():

     print(
         "[SUCCESS] Î™®Îì† ÌÖåÏä§Ìä∏ ÌÜµÍ≥º! AAA Storage Ìè¨Ìï® ÎèôÏùº ÎÇ†Ïßú Ï∞ΩÍ≥†Í∞Ñ Ïù¥Îèô Î°úÏßÅ Í≤ÄÏ¶ù ÏôÑÎ£å"
     )
     return True


 def validate_inventory_logic(df: pd.DataFrame) -> bool:
     """‚úÖ Status_Location Í∏∞Î∞ò Ïû¨Í≥† Î°úÏßÅ Í≤ÄÏ¶ù"""
     print("üîç Status_Location Í∏∞Î∞ò Ïû¨Í≥† Î°úÏßÅ Í≤ÄÏ¶ù ÏãúÏûë...")

     if "Status_Location" not in df.columns:
         print("‚ùå Status_Location Ïª¨ÎüºÏù¥ ÏóÜÏäµÎãàÎã§.")
         return False

     # Status_Location Î∂ÑÌè¨ ÌôïÏù∏
     status_distribution = df["Status_Location"].value_counts()
     print(f"üìä Status_Location Î∂ÑÌè¨:")
     for location, count in status_distribution.head(10).items():
         print(f"   {location}: {count:,}Í±¥")

     # Ï∞ΩÍ≥† vs ÌòÑÏû• Î∂ÑÎ¶¨ ÌôïÏù∏
     warehouse_count = 0
     site_count = 0

-    warehouse_columns = [
-        "AAA Storage",
-        "DSV Al Markaz",
-        "DSV Indoor",
-        "DSV MZP",
-        "DSV Outdoor",
-        "Hauler Indoor",
-        "MOSB",
-        "DHL Warehouse",
-    ]
-    site_columns = ["AGI", "DAS", "MIR", "SHU"]
+    calculator = CorrectedWarehouseIOCalculator()
+    warehouse_columns = list(calculator.warehouse_columns)
+    site_columns = list(calculator.site_columns)

     for location in status_distribution.index:
         if location in warehouse_columns:
             warehouse_count += status_distribution[location]
         elif location in site_columns:
             site_count += status_distribution[location]

     print(f"üè¢ Ï∞ΩÍ≥† Ïû¨Í≥†: {warehouse_count:,}Í±¥")
     print(f"üèóÔ∏è ÌòÑÏû• Ïû¨Í≥†: {site_count:,}Í±¥")
     print(f"üì¶ Ï¥ù Ïû¨Í≥†: {warehouse_count + site_count:,}Í±¥")

     return True


 def validate_patch_effectiveness():
     """‚úÖ Ìå®Ïπò Ìö®Í≥º Í≤ÄÏ¶ù Ìï®Ïàò Ï∂îÍ∞Ä"""
     print("[VALIDATION] Ìå®Ïπò Ìö®Í≥º Í≤ÄÏ¶ù ÏãúÏûë...")

     try:
         # ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî
         reporter = HVDCExcelReporterFinal()

         # Ï¢ÖÌï© ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
         stats = reporter.calculate_warehouse_statistics()

diff --git a/hitachi/tests/test_stage1_warehouse_alignment.py b/hitachi/tests/test_stage1_warehouse_alignment.py
new file mode 100644
index 0000000000000000000000000000000000000000..29237f01921274c79d7817412f10790090ca87d9
--- /dev/null
+++ b/hitachi/tests/test_stage1_warehouse_alignment.py
@@ -0,0 +1,63 @@
+"""Stage-1 Ï∞ΩÍ≥† Ìó§Îçî Ï†ïÍ∑úÌôî ÌÖåÏä§Ìä∏/Stage-1 warehouse header compatibility."""
+
+from __future__ import annotations
+
+import importlib.util
+from pathlib import Path
+from types import ModuleType
+
+import pandas as pd
+
+
+def _load_reporter_module() -> ModuleType:
+    """Stage-1 Î™®ÎìàÏóêÏÑú Î¶¨Ìè¨ÌÑ∞ Î°úÎìú/Load reporter from Stage-1 module."""
+
+    module_dir = Path(__file__).parent.parent
+    module_path = module_dir / "hvdc_excel_reporter_final_sqm_rev (1).py"
+    spec = importlib.util.spec_from_file_location(
+        "hvdc_excel_reporter_final_sqm_rev", module_path
+    )
+    module = importlib.util.module_from_spec(spec)
+    if spec.loader is None:
+        raise RuntimeError("Unable to load hvdc_excel_reporter module")
+    spec.loader.exec_module(module)
+    return module
+
+
+def test_stage1_warehouse_columns_support() -> None:
+    """HAULER¬∑JDN MZD ÏûÖÏ∂úÍ≥†¬∑SQM Î∞òÏòÅ/Ensure HAULER¬∑JDN MZD appear in IO & SQM."""
+
+    module = _load_reporter_module()
+    calculator = module.CorrectedWarehouseIOCalculator()
+
+    df = pd.DataFrame(
+        [
+            {
+                "Pkg": 1,
+                "HAULER": pd.Timestamp("2024-05-01"),
+                "MIR": pd.Timestamp("2024-05-02"),
+            },
+            {
+                "Pkg": 2,
+                "JDN MZD": pd.Timestamp("2024-06-01"),
+                "SHU": pd.Timestamp("2024-06-03"),
+            },
+        ]
+    )
+
+    inbound = calculator.calculate_warehouse_inbound_corrected(df)
+    outbound = calculator.calculate_warehouse_outbound_corrected(df)
+    sqm_inbound = calculator.calculate_monthly_sqm_inbound(df)
+    sqm_outbound = calculator.calculate_monthly_sqm_outbound(df)
+
+    assert inbound["by_warehouse"]["HAULER"] == 1
+    assert inbound["by_warehouse"]["JDN MZD"] == 2
+
+    assert outbound["by_warehouse"]["HAULER"] == 1
+    assert outbound["by_warehouse"]["JDN MZD"] == 2
+
+    assert "HAULER" in sqm_inbound["2024-05"]
+    assert "JDN MZD" in sqm_inbound["2024-06"]
+
+    assert "HAULER" in sqm_outbound["2024-05"]
+    assert "JDN MZD" in sqm_outbound["2024-06"]
